# Data Storage Knowledge

## Directory Structure
- All data files stored in `/data` (gitignored)
- Each ledger has multiple associated files:
  - `{ledger}-snapshot.txt` - Last processed state
  - `{ledger}-balances.txt` - Current balances
  - `{ledger}-transactions.csv` - Transaction history
  - `{ledger}-{user}.txt` - Per-user transaction histories

## File Formats
### Snapshot Files
- Complete ledger state when balances were last computed
- Includes account definitions and all transactions
- Used as source of truth for balance calculations

### Balance Files
- Generated by ledger.m
- Shows current balance for each user
- Updated via long-polling mechanism

### Transaction CSV
- Columns: Date, Amount, From, To, Reason, Balance
- Used for exports and history views
- Generated nightly by nightly.m

### User Transaction Files
- Individual transaction histories
- Only shows transactions involving that user
- Updated nightly
- Format matches main transaction CSV